title: PV Production
views:
  - title: PV Panel Layout
    path: pv-layout
    panel: true
    cards:
      - type: vertical-stack
        cards:
          # ════════════════════════════════════════════════════════
          # TOP ROOF — 26-Column Grid (Forces panels to render smaller)
          # ════════════════════════════════════════════════════════
          - type: custom:layout-card
            layout_type: custom:grid-layout
            layout:
              grid-template-columns: repeat(26, 1fr)
              grid-gap: 6px
              margin: 0
            cards:
              # Row 1: C2 & C3 (Landscape, 3 cols each, perfectly centered)
              - type: custom:button-card
                entity: sensor.tigo_ts4_c2_daily_energy
                name: C2
                show_state: true
                show_icon: false
                view_layout: { grid-row: 1, grid-column: 11 / 14 }
                styles: &tile_landscape
                  card:
                    - aspect-ratio: 3/2
                    - border-radius: 4px
                    - border: "1px solid #3b4252"
                    - background: >
                        [[[
                          const max = parseFloat(states['sensor.tigo_max_daily_energy']?.state) || 1;
                          const val = parseFloat(entity.state) || 0;
                          const pct = Math.min(Math.max(val, 0) / max, 1);
                          const alpha = pct * 0.7;
                          return `linear-gradient(rgba(0, 220, 50, ${alpha}), rgba(0, 220, 50, ${alpha})), linear-gradient(135deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0) 40%, rgba(0,0,0,0.6) 100%), repeating-linear-gradient(0deg, transparent, transparent 18%, rgba(255,255,255,0.1) 18%, rgba(255,255,255,0.1) 20%), repeating-linear-gradient(90deg, transparent, transparent 18%, rgba(255,255,255,0.1) 18%, rgba(255,255,255,0.1) 20%), #0a111a`;
                        ]]]
                    - box-shadow: >
                        [[[
                          const max = parseFloat(states['sensor.tigo_max_daily_energy']?.state) || 1;
                          const val = parseFloat(entity.state) || 0;
                          const pct = Math.min(Math.max(val, 0) / max, 1);
                          return `0 4px 8px rgba(0,0,0,0.5), inset 0 0 ${15 * pct}px rgba(0, 255, 50, ${0.8 * pct})`;
                        ]]]
                  name:
                    - font-size: 1.0em
                    - font-weight: 800
                    - color: white
                    - text-shadow: "1px 1px 2px rgba(0,0,0,0.8)"
                  state:
                    - font-size: 0.85em
                    - font-weight: 600
                    - color: "#e5e9f0"
                    - text-shadow: "1px 1px 2px rgba(0,0,0,0.8)"

              - type: custom:button-card
                entity: sensor.tigo_ts4_c3_daily_energy
                name: C3
                show_state: true
                show_icon: false
                view_layout: { grid-row: 1, grid-column: 14 / 17 }
                styles: *tile_landscape

              # Row 2: C4-C7 (Portrait, 2 cols each)
              - type: custom:button-card
                entity: sensor.tigo_ts4_c4_daily_energy
                name: C4
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 9 / 11 }
                styles: &tile_portrait
                  card:
                    - aspect-ratio: 2/3
                    - border-radius: 4px
                    - border: "1px solid #3b4252"
                    - background: >
                        [[[
                          const max = parseFloat(states['sensor.tigo_max_daily_energy']?.state) || 1;
                          const val = parseFloat(entity.state) || 0;
                          const pct = Math.min(Math.max(val, 0) / max, 1);
                          const alpha = pct * 0.7;
                          return `linear-gradient(rgba(0, 220, 50, ${alpha}), rgba(0, 220, 50, ${alpha})), linear-gradient(135deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0) 40%, rgba(0,0,0,0.6) 100%), repeating-linear-gradient(0deg, transparent, transparent 18%, rgba(255,255,255,0.1) 18%, rgba(255,255,255,0.1) 20%), repeating-linear-gradient(90deg, transparent, transparent 18%, rgba(255,255,255,0.1) 18%, rgba(255,255,255,0.1) 20%), #0a111a`;
                        ]]]
                    - box-shadow: >
                        [[[
                          const max = parseFloat(states['sensor.tigo_max_daily_energy']?.state) || 1;
                          const val = parseFloat(entity.state) || 0;
                          const pct = Math.min(Math.max(val, 0) / max, 1);
                          return `0 4px 8px rgba(0,0,0,0.5), inset 0 0 ${15 * pct}px rgba(0, 255, 50, ${0.8 * pct})`;
                        ]]]
                  name:
                    - font-size: 1.0em
                    - font-weight: 800
                    - color: white
                    - text-shadow: "1px 1px 2px rgba(0,0,0,0.8)"
                  state:
                    - font-size: 0.85em
                    - font-weight: 600
                    - color: "#e5e9f0"
                    - text-shadow: "1px 1px 2px rgba(0,0,0,0.8)"

              - type: custom:button-card
                entity: sensor.tigo_ts4_c10_daily_energy
                name: C10
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 11 / 13 }
                styles: *tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_c9_daily_energy
                name: C9
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 13 / 15 }
                styles: *tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_c8_daily_energy
                name: C8
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 15 / 17 }
                styles: *tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_c7_daily_energy
                name: C7
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 17 / 19 }
                styles: *tile_portrait

          # Smaller Spacer
          - type: custom:button-card
            color_type: blank-card
            styles:
              card:
                [height: 20px, background: none, box-shadow: none, border: none]

          # ════════════════════════════════════════════════════════
          # BOTTOM ROOF
          # ════════════════════════════════════════════════════════
          - type: custom:layout-card
            layout_type: custom:grid-layout
            layout:
              grid-template-columns: repeat(26, 1fr)
              grid-gap: 6px
              margin: 0
            cards:
              # Row 3
              - type: custom:button-card
                entity: sensor.tigo_ts4_c1_daily_energy
                name: C1
                show_state: true
                show_icon: false
                view_layout: { grid-row: 1, grid-column: 8 / 10 }
                styles: *tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_c6_daily_energy
                name: C6
                show_state: true
                show_icon: false
                view_layout: { grid-row: 1, grid-column: 10 / 12 }
                styles: *tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_d6_daily_energy
                name: D6
                show_state: true
                show_icon: false
                view_layout: { grid-row: 1, grid-column: 12 / 14 }
                styles: *tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_d7_daily_energy
                name: D7
                show_state: true
                show_icon: false
                view_layout: { grid-row: 1, grid-column: 14 / 16 }
                styles: *tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_d8_daily_energy
                name: D8
                show_state: true
                show_icon: false
                view_layout: { grid-row: 1, grid-column: 16 / 18 }
                styles: *tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_d9_daily_energy
                name: D9
                show_state: true
                show_icon: false
                view_layout: { grid-row: 1, grid-column: 18 / 20 }
                styles: *tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_c11_daily_energy
                name: C11
                show_state: true
                show_icon: false
                view_layout: { grid-row: 1, grid-column: 20 / 22 }
                styles: *tile_portrait

              # Row 4
              - type: custom:button-card
                entity: sensor.tigo_ts4_d11_daily_energy
                name: D11
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 4 / 6 }
                styles: *tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_d5_daily_energy
                name: D5
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 6 / 8 }
                styles: *tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_c12_daily_energy
                name: C12
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 8 / 10 }
                styles: *tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_d4_daily_energy
                name: D4
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 10 / 12 }
                styles: *tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_d3_daily_energy
                name: D3
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 12 / 14 }
                styles: *tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_d1_daily_energy
                name: D1
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 14 / 16 }
                styles: *tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_d2_daily_energy
                name: D2
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 16 / 18 }
                styles: *tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_c5_daily_energy
                name: C5
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 18 / 20 }
                styles: *tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_c13_daily_energy
                name: C13
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 20 / 22 }
                styles: *tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_d10_daily_energy
                name: D10
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 22 / 24 }
                styles: *tile_portrait

  # ═══════════════════════════════════════════════════════════
  # PAGE 2 — Panel Connectivity
  # ═══════════════════════════════════════════════════════════
  - title: Panel Connectivity
    path: panel-connectivity
    panel: true
    cards:
      - type: vertical-stack
        cards:
          - type: custom:layout-card
            layout_type: custom:grid-layout
            layout:
              grid-template-columns: repeat(26, 1fr)
              grid-gap: 6px
              margin: 0
            cards:
              - type: custom:button-card
                entity: sensor.tigo_ts4_c2_readings_today
                name: C2
                show_state: true
                show_icon: false
                view_layout: { grid-row: 1, grid-column: 11 / 14 }
                styles: &conn_tile_landscape
                  card:
                    - aspect-ratio: 3/2
                    - border-radius: 4px
                    - border: "1px solid #3b4252"
                    - background: >
                        [[[
                          const max = parseFloat(states['sensor.tigo_max_readings_today']?.state) || 1;
                          const val = parseFloat(entity.state) || 0;
                          const pct = Math.min(Math.max(val, 0) / max, 1);
                          const hue = Math.round(pct * 120);
                          const alpha = 0.55;
                          return `linear-gradient(hsla(${hue}, 80%, 50%, ${alpha}), hsla(${hue}, 80%, 50%, ${alpha})), linear-gradient(135deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0) 40%, rgba(0,0,0,0.6) 100%), repeating-linear-gradient(0deg, transparent, transparent 18%, rgba(255,255,255,0.1) 18%, rgba(255,255,255,0.1) 20%), repeating-linear-gradient(90deg, transparent, transparent 18%, rgba(255,255,255,0.1) 18%, rgba(255,255,255,0.1) 20%), #0a111a`;
                        ]]]
                    - box-shadow: >
                        [[[
                          const max = parseFloat(states['sensor.tigo_max_readings_today']?.state) || 1;
                          const val = parseFloat(entity.state) || 0;
                          const pct = Math.min(Math.max(val, 0) / max, 1);
                          const hue = Math.round(pct * 120);
                          return `0 4px 8px rgba(0,0,0,0.5), inset 0 0 12px hsla(${hue}, 80%, 50%, 0.7)`;
                        ]]]
                  name:
                    - font-size: 1.0em
                    - font-weight: 800
                    - color: white
                    - text-shadow: "1px 1px 2px rgba(0,0,0,0.8)"
                  state:
                    - font-size: 0.85em
                    - font-weight: 600
                    - color: "#e5e9f0"
                    - text-shadow: "1px 1px 2px rgba(0,0,0,0.8)"

              - type: custom:button-card
                entity: sensor.tigo_ts4_c3_readings_today
                name: C3
                show_state: true
                show_icon: false
                view_layout: { grid-row: 1, grid-column: 14 / 17 }
                styles: *conn_tile_landscape

              - type: custom:button-card
                entity: sensor.tigo_ts4_c4_readings_today
                name: C4
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 9 / 11 }
                styles: &conn_tile_portrait
                  card:
                    - aspect-ratio: 2/3
                    - border-radius: 4px
                    - border: "1px solid #3b4252"
                    - background: >
                        [[[
                          const max = parseFloat(states['sensor.tigo_max_readings_today']?.state) || 1;
                          const val = parseFloat(entity.state) || 0;
                          const pct = Math.min(Math.max(val, 0) / max, 1);
                          const hue = Math.round(pct * 120);
                          const alpha = 0.55;
                          return `linear-gradient(hsla(${hue}, 80%, 50%, ${alpha}), hsla(${hue}, 80%, 50%, ${alpha})), linear-gradient(135deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0) 40%, rgba(0,0,0,0.6) 100%), repeating-linear-gradient(0deg, transparent, transparent 18%, rgba(255,255,255,0.1) 18%, rgba(255,255,255,0.1) 20%), repeating-linear-gradient(90deg, transparent, transparent 18%, rgba(255,255,255,0.1) 18%, rgba(255,255,255,0.1) 20%), #0a111a`;
                        ]]]
                    - box-shadow: >
                        [[[
                          const max = parseFloat(states['sensor.tigo_max_readings_today']?.state) || 1;
                          const val = parseFloat(entity.state) || 0;
                          const pct = Math.min(Math.max(val, 0) / max, 1);
                          const hue = Math.round(pct * 120);
                          return `0 4px 8px rgba(0,0,0,0.5), inset 0 0 12px hsla(${hue}, 80%, 50%, 0.7)`;
                        ]]]
                  name:
                    - font-size: 1.0em
                    - font-weight: 800
                    - color: white
                    - text-shadow: "1px 1px 2px rgba(0,0,0,0.8)"
                  state:
                    - font-size: 0.85em
                    - font-weight: 600
                    - color: "#e5e9f0"
                    - text-shadow: "1px 1px 2px rgba(0,0,0,0.8)"

              - type: custom:button-card
                entity: sensor.tigo_ts4_c10_readings_today
                name: C10
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 11 / 13 }
                styles: *conn_tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_c9_readings_today
                name: C9
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 13 / 15 }
                styles: *conn_tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_c8_readings_today
                name: C8
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 15 / 17 }
                styles: *conn_tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_c7_readings_today
                name: C7
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 17 / 19 }
                styles: *conn_tile_portrait

          - type: custom:button-card
            color_type: blank-card
            styles:
              card:
                [height: 20px, background: none, box-shadow: none, border: none]

          - type: custom:layout-card
            layout_type: custom:grid-layout
            layout:
              grid-template-columns: repeat(26, 1fr)
              grid-gap: 6px
              margin: 0
            cards:
              - type: custom:button-card
                entity: sensor.tigo_ts4_c1_readings_today
                name: C1
                show_state: true
                show_icon: false
                view_layout: { grid-row: 1, grid-column: 8 / 10 }
                styles: *conn_tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_c6_readings_today
                name: C6
                show_state: true
                show_icon: false
                view_layout: { grid-row: 1, grid-column: 10 / 12 }
                styles: *conn_tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_d6_readings_today
                name: D6
                show_state: true
                show_icon: false
                view_layout: { grid-row: 1, grid-column: 12 / 14 }
                styles: *conn_tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_d7_readings_today
                name: D7
                show_state: true
                show_icon: false
                view_layout: { grid-row: 1, grid-column: 14 / 16 }
                styles: *conn_tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_d8_readings_today
                name: D8
                show_state: true
                show_icon: false
                view_layout: { grid-row: 1, grid-column: 16 / 18 }
                styles: *conn_tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_d9_readings_today
                name: D9
                show_state: true
                show_icon: false
                view_layout: { grid-row: 1, grid-column: 18 / 20 }
                styles: *conn_tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_c11_readings_today
                name: C11
                show_state: true
                show_icon: false
                view_layout: { grid-row: 1, grid-column: 20 / 22 }
                styles: *conn_tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_d11_readings_today
                name: D11
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 4 / 6 }
                styles: *conn_tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_d5_readings_today
                name: D5
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 6 / 8 }
                styles: *conn_tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_c12_readings_today
                name: C12
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 8 / 10 }
                styles: *conn_tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_d4_readings_today
                name: D4
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 10 / 12 }
                styles: *conn_tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_d3_readings_today
                name: D3
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 12 / 14 }
                styles: *conn_tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_d1_readings_today
                name: D1
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 14 / 16 }
                styles: *conn_tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_d2_readings_today
                name: D2
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 16 / 18 }
                styles: *conn_tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_c5_readings_today
                name: C5
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 18 / 20 }
                styles: *conn_tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_c13_readings_today
                name: C13
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 20 / 22 }
                styles: *conn_tile_portrait

              - type: custom:button-card
                entity: sensor.tigo_ts4_d10_readings_today
                name: D10
                show_state: true
                show_icon: false
                view_layout: { grid-row: 2, grid-column: 22 / 24 }
                styles: *conn_tile_portrait
